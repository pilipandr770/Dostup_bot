# Деплой Docker образа бота на DigitalOcean App Platform

DigitalOcean App Platform предоставляет простой способ деплоя Docker контейнеров без необходимости управления инфраструктурой. Вот пошаговое руководство по деплою вашего бота.

## Преимущества DigitalOcean App Platform

1. **Простота деплоя** - автоматический деплой из репозитория или registry
2. **Не нужно управлять серверами** - DigitalOcean делает это за вас
3. **Масштабируемость** - легко увеличить мощность при необходимости
4. **Постоянное хранилище** - возможность подключения томов
5. **Мониторинг и логи** - встроенные инструменты

## Подготовка к деплою

1. **Создайте аккаунт на DigitalOcean**:
   - Перейдите на [DigitalOcean](https://www.digitalocean.com/)
   - Зарегистрируйтесь (можно использовать промо-код для бесплатных кредитов)

2. **Подготовьте Docker образ**:
   - Проверьте, что Dockerfile настроен правильно
   - Убедитесь, что бот корректно работает в Docker контейнере локально

## Процесс деплоя

### Вариант 1: Деплой из GitHub репозитория

1. **Подключение репозитория**:
   - В DigitalOcean Dashboard выберите "Apps" > "Create App"
   - Выберите "GitHub" как источник
   - Предоставьте доступ к вашему GitHub аккаунту
   - Выберите ваш репозиторий с ботом

2. **Настройка деплоя**:
   - Выберите ветку (обычно main или master)
   - DigitalOcean автоматически обнаружит Dockerfile
   - Выберите "Dockerfile" как тип приложения
   - Нажмите "Next"

3. **Настройка окружения**:
   - Укажите тип приложения "Web Service"
   - Добавьте все необходимые переменные окружения:
     - BOT_TOKEN
     - COURSE_CHANNEL_ID
     - YOUTUBE_CHANNEL_URL
     - CHANNEL_INVITE_LINK
     - OPENAI_API_KEY
     - OPENAI_ASSISTANT_ID
     - STRIPE_PAYMENT_URL
     - ADMIN_USER_ID
     - STRIPE_API_KEY
   - Нажмите "Next"

4. **Настройка плана**:
   - Выберите Basic или Pro план (для начала достаточно Basic)
   - Выберите регион, ближайший к вашей целевой аудитории
   - Нажмите "Launch App"

### Вариант 2: Деплой из Docker Hub

1. **Загрузка образа в Docker Hub**:
   ```bash
   docker build -t yourusername/dostup-bot .
   docker push yourusername/dostup-bot
   ```

2. **Создание приложения**:
   - В DigitalOcean Dashboard выберите "Apps" > "Create App"
   - Выберите "Docker Hub" как источник
   - Введите название образа (yourusername/dostup-bot)
   - Нажмите "Next"

3. **Настройка окружения и плана**:
   - Следуйте тем же шагам, что и для GitHub деплоя

## Настройка хранилища данных

1. **Добавление тома (volume)**:
   - После создания приложения перейдите в его настройки
   - Выберите "Components" > ваш сервис > "Edit"
   - В разделе "Volumes" добавьте новый том
   - Укажите путь монтирования `/app` (совпадает с Docker)
   - Выберите размер тома (начните с 1GB)
   - Сохраните изменения

## Мониторинг и логи

- **Логи**: Dashboard > Ваше приложение > "Logs"
- **Мониторинг**: Dashboard > Ваше приложение > "Metrics"
- **Консоль**: Dashboard > Ваше приложение > "Console" (для выполнения команд)

## Перезапуск и обновление

- **Ручное обновление**: Нажмите "Deploy" в Dashboard приложения
- **Автоматическое обновление**: Настройте GitHub Actions или включите автоматический деплой

## Стоимость

- Basic план начинается от $5/месяц
- При регистрации можно получить кредиты на $100 (действуют 60 дней)
- Для телеграм-бота обычно достаточно минимального плана

## Поддержка

Если возникают проблемы с деплоем:
- [Документация DigitalOcean App Platform](https://docs.digitalocean.com/products/app-platform/)
- [Сообщество DigitalOcean](https://www.digitalocean.com/community)
