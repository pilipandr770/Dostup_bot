# Настройка системы напоминаний

В боте реализована система автоматических напоминаний для пользователей, которые посмотрели бесплатный урок, но не оплатили курс.

## Как это работает

1. Когда пользователь запрашивает бесплатный урок, система записывает это событие в базу данных SQLite.
2. В заданные интервалы времени (1 день, 3 дня и 7 дней после просмотра) система отправляет напоминания пользователям.
3. Если пользователь оплачивает курс, напоминания автоматически прекращаются.

## Настройка для Docker

Если вы используете Docker, добавьте том в `docker-compose.yml` для сохранения базы данных между перезапусками:

```yaml
version: '3'

services:
  telegram-bot:
    build: .
    restart: always
    volumes:
      - ./app:/app
      - ./app/bot_debug.log:/app/bot_debug.log
      - ./app/reminder_data.db:/app/reminder_data.db  # Добавьте эту строку
    env_file:
      - .env
```

## Настройка сообщений напоминаний

Шаблоны сообщений настраиваются в файле `reminder_system.py`. По умолчанию настроены следующие шаблоны:

```python
DEFAULT_REMINDER_INTERVALS = [
    {"days": 1, "template": "Привет! Как тебе бесплатный урок? Готов ли ты углубиться в тему и получить полный доступ к курсу?"},
    {"days": 3, "template": "Здравствуй! Прошло несколько дней с того момента, как ты посмотрел наш бесплатный урок. Не хочешь получить доступ к полному курсу, чтобы узнать все секреты?"},
    {"days": 7, "template": "Привет! Уже неделя прошла с момента просмотра бесплатного урока. Самое время присоединиться к нашему сообществу и получить полный доступ к курсу!"}
]
```

Вы можете изменить интервалы (`days`) и тексты сообщений (`template`), а также добавить дополнительные напоминания.

## Генерация сообщений с помощью OpenAI

Если у вас настроен OpenAI API, система может использовать Assistant API для генерации персонализированных напоминаний. Для этого необходимо настроить:

1. `OPENAI_API_KEY` - ваш API ключ OpenAI
2. `OPENAI_ASSISTANT_ID` - ID созданного ассистента

## Команды для администратора

В боте реализована команда для проверки статистики работы системы напоминаний:

- `/reminders` или `статистика напоминаний` - показывает количество пользователей с напоминаниями, отправленных сообщений и конверсию в покупки.

## Журналирование

Система напоминаний записывает логи своей работы в общий файл лога бота (`bot_debug.log`). Если вы хотите проверить, правильно ли работает система, проверьте этот файл.
